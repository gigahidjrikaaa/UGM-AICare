# ================================
# Backend environment template
# ================================
# Copy to backend/.env for local development or provide via platform secrets.

# ============================================
# Database
# ============================================
# Canonical database URL (async driver for application)
# - Local example:
#   DATABASE_URL=postgresql+asyncpg://user:password@localhost:5432/aicare_db
# - NeonDB example (SSL required):
#   DATABASE_URL=postgresql+asyncpg://user:password@ep-xxxx.neon.tech/neondb?sslmode=require
DATABASE_URL=

# Optional: force SSL usage for managed Postgres providers (e.g., NeonDB).
# If DATABASE_URL already includes `?sslmode=require`, the backend will infer SSL automatically.
# Valid values: true/false
DB_SSL=

# Advanced settings (optional)
DEBUG_SQL=false
K_ANON=15
FOLLOWUP_COOLDOWN_HOURS=24
SDA_SLA_MINUTES=15
POLICY_DENY_EXPERIMENTS_ON_CRISIS=true

# ============================================
# Security & Encryption
# ============================================
# Generate with: openssl rand -base64 32
JWT_SECRET_KEY=CHANGE_THIS_JWT_SECRET_KEY
EMAIL_ENCRYPTION_KEY=CHANGE_THIS_EMAIL_ENCRYPTION_KEY
INTERNAL_API_KEY=CHANGE_THIS_INTERNAL_API_KEY
JWT_EXPIRATION_TIME=3600

# ============================================
# Redis Configuration
# ============================================
# Optional (recommended): single URL form. Use `rediss://` if your provider requires TLS.
# If REDIS_URL is set, it takes precedence over REDIS_HOST/REDIS_PORT.
REDIS_URL=

# Host/port form (optional)
REDIS_HOST=
REDIS_DB=0
REDIS_PORT=6379
REDIS_USERNAME=
REDIS_PASSWORD=

# Optional: only used when configuring via REDIS_HOST/REDIS_PORT.
# Valid values: true/false
REDIS_SSL=

# Celery should point to the same Redis instance (if Celery is used).
CELERY_BROKER_URL=
CELERY_RESULT_BACKEND=

# ============================================
# MinIO Object Storage
# ============================================
MINIO_ENDPOINT=minio:9000
MINIO_ACCESS_KEY=YOUR_MINIO_ACCESS_KEY
MINIO_SECRET_KEY=YOUR_MINIO_SECRET_KEY
MINIO_BUCKET=content-resources
MINIO_SECURE=false

# ============================================
# API Keys
# ============================================
# Google Gemini API (required for AI features)
GOOGLE_GENAI_API_KEY=YOUR_GOOGLE_GEMINI_API_KEY
GOOGLE_GENAI_API_KEY_2=
GOOGLE_GENAI_API_KEY_3=
GOOGLE_GENAI_API_KEY_4=
GOOGLE_GENAI_API_KEY_5=

# Azure OpenAI (optional)
AZURE_OPENAI_ENDPOINT=
AZURE_OPENAI_API_KEY=
AZURE_OPENAI_DEPLOYMENT=

# Together AI (optional)
TOGETHER_API_KEY=

# OpenRouter (optional)
OPENROUTER_API_KEY=

# ============================================
# Twitter API (optional)
# ============================================
TWITTER_API_KEY=
TWITTER_API_SECRET=
TWITTER_ACCESS_TOKEN=
TWITTER_ACCESS_TOKEN_SECRET=
TWITTER_BEARER_TOKEN=

# ============================================
# Email Configuration
# ============================================
EMAIL_USERNAME=
EMAIL_PASSWORD=
EMAIL_SMTP_SERVER=smtp.gmail.com
EMAIL_SMTP_PORT=587

# ============================================
# Backend URLs & Runtime
# ============================================
APP_ENV=production
PORT=22001
FRONTEND_URL=https://aicare.sumbu.xyz
BACKEND_URL=https://api.aicare.sumbu.xyz
ALLOWED_ORIGINS=https://aicare.sumbu.xyz,http://localhost:22000,http://127.0.0.1:22000
LOG_LEVEL=INFO
WORKERS_PER_CORE=4

# ============================================
# Rate Limiting Configuration
# ============================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_BYPASS_ADMIN=true
RATE_LIMIT_CHAT_PER_MINUTE_STUDENT=10
RATE_LIMIT_CHAT_PER_HOUR_STUDENT=100
RATE_LIMIT_CHAT_PER_DAY_STUDENT=500
RATE_LIMIT_CHAT_PER_MINUTE_COUNSELLOR=30
RATE_LIMIT_CHAT_PER_HOUR_COUNSELLOR=300
RATE_LIMIT_CHAT_PER_DAY_COUNSELLOR=2000
RATE_LIMIT_ANALYTICS_PER_MINUTE_STUDENT=5
RATE_LIMIT_ANALYTICS_PER_HOUR_STUDENT=30
RATE_LIMIT_ANALYTICS_PER_DAY_STUDENT=100

# ============================================
# Caching Configuration
# ============================================
CACHE_ENABLED=true
CACHE_DEFAULT_TTL=3600           # 1 hour
CACHE_USER_SUMMARY_TTL=1800      # 30 minutes
CACHE_JOURNAL_TTL=900            # 15 minutes
CACHE_RESOURCE_TTL=86400         # 24 hours
CACHE_CBT_MODULE_TTL=86400       # 24 hours
CACHE_USER_PROFILE_TTL=3600      # 1 hour

# ============================================
# PII Redaction
# ============================================
PII_REDACTION_ENABLED=true
PII_NLP_REDACTION_ENABLED=false
PII_REDACTION_ENTITIES=PERSON,GPE,LOC
PII_NLP_MODEL=xx_ent_wiki_sm

# ============================================
# Scheduler / Retention Jobs
# ============================================
PROACTIVE_CHECKINS_REQUIRE_REVIEW=
ENABLE_RETENTION_COHORT_JOB=true
RETENTION_COHORT_DAYS=30
RETENTION_DAY_N_VALUES=1,7,30

# ============================================
# Autopilot (Aika policy-governed actions)
# ============================================
AUTOPILOT_ENABLED=true
AUTOPILOT_MAX_RETRIES=5
AUTOPILOT_RETRY_BASE_SECONDS=30
AUTOPILOT_WORKER_INTERVAL_SECONDS=5
AUTOPILOT_REQUIRE_APPROVAL_HIGH_RISK=true
AUTOPILOT_REQUIRE_APPROVAL_CRITICAL_RISK=true
AUTOPILOT_POLICY_VERSION=v1
# Demo-only mode: onchain autopilot actions generate synthetic tx hashes (no real tx submit).
# Set to false only after real blockchain handlers are implemented in autopilot_worker.
AUTOPILOT_ONCHAIN_PLACEHOLDER=true

# ============================================
# n8n Integrations (optional)
# ============================================
N8N_WEBHOOK_URL=
N8N_INTERVENTION_WEBHOOK_URL=
N8N_API_KEY=
INTERVENTION_DEFAULT_CTA_URL=

# ============================================
# Langfuse (optional)
# ============================================
LANGFUSE_ENABLED=false
LANGFUSE_HOST=
LANGFUSE_SECRET=
LANGFUSE_SALT=
LANGFUSE_PUBLIC_KEY=
LANGFUSE_SECRET_KEY=

# ============================================
# Admin/Counselor Bootstrap
# ============================================
ADMIN_EMAIL=admin@yourdomain.com
ADMIN_PASSWORD=CHANGE_THIS_STRONG_PASSWORD
COUNSELOR_EMAIL=counselor@yourdomain.com
COUNSELOR_PASSWORD=CHANGE_THIS_STRONG_PASSWORD
COUNSELOR_NAME=Main Counselor

# Development toggle
ALLOW_DEV_CREDENTIALS=false

# ============================================
# Web3 / Blockchain (optional)
# ============================================
# EDUChain Testnet (Journal NFT Badges)
NFT_CONTRACT_ADDRESS=
EDU_TESTNET_RPC_URL=
EDU_CHAIN_TESTNET_CHAIN_ID=656476

# BNB Smart Chain (Multi-Chain Badge NFTs)
BSC_TESTNET_RPC_URL=
BSC_NFT_CONTRACT_ADDRESS=
BSC_MINTER_PRIVATE_KEY=
BSC_MAINNET_RPC_URL=
BSC_MAINNET_NFT_CONTRACT_ADDRESS=
BSC_MAINNET_MINTER_PRIVATE_KEY=

# BNB Smart Chain (Autopilot Attestation Registry)
BSC_ATTESTATION_CONTRACT_ADDRESS=
BSC_ATTESTATION_PUBLISHER_PRIVATE_KEY=
BSC_MAINNET_ATTESTATION_CONTRACT_ADDRESS=
BSC_MAINNET_ATTESTATION_PUBLISHER_PRIVATE_KEY=

# SOMNIA Blockchain ($CARE Token)
SOMNIA_RPC_URL=
CARE_TOKEN_ADDRESS=
CARE_TOKEN_NETWORK=testnet
PLATFORM_REVENUE_ORACLE_ADDRESS=
CARE_TOKEN_CONTROLLER_ADDRESS=
CARE_STAKING_HALAL_ADDRESS=

# Private Keys (SECURITY CRITICAL - NEVER COMMIT REAL VALUES!)
BACKEND_MINTER_PRIVATE_KEY=
FINANCE_TEAM_PRIVATE_KEY=
CARE_MINTER_PRIVATE_KEY=

# ============================================
# Open Campus ID (OCID) â€” JWT verification
# ============================================
# Leave OCID_SANDBOX=true during development; set to false in production.
# In sandbox mode, the backend verifies tokens against the Open Campus sandbox
# JWKS endpoint (no registration required).
OCID_SANDBOX=true

# Required only in live (non-sandbox) mode after whitelist approval:
OCID_CLIENT_ID=
