# ================================
# ENVIRONMENT CONFIGURATION
# ================================
# This is a template file - copy to .env and fill in your values
# For production: Use strong, randomly generated secrets
# For development: Adjust URLs to localhost

# ============================================
# Database
# ============================================
# Canonical database URL (async driver for application)
# - Local example:
#   DATABASE_URL=postgresql+asyncpg://user:password@localhost:5432/aicare_db
# - NeonDB example (SSL required):
#   DATABASE_URL=postgresql+asyncpg://user:password@ep-xxxx.neon.tech/neondb?sslmode=require
DATABASE_URL=

# Optional: force SSL usage for managed Postgres providers (e.g., NeonDB).
# If DATABASE_URL already includes `?sslmode=require`, the backend will infer SSL automatically.
# Valid values: true/false
DB_SSL=

# ============================================
# Security & Encryption
# ============================================
# Generate with: openssl rand -base64 32
JWT_SECRET_KEY=CHANGE_THIS_JWT_SECRET_KEY
EMAIL_ENCRYPTION_KEY=CHANGE_THIS_EMAIL_ENCRYPTION_KEY
INTERNAL_API_KEY=CHANGE_THIS_INTERNAL_API_KEY
JWT_EXPIRATION_TIME=3600

# NextAuth Secret (CRITICAL - REQUIRED)
# Generate with: openssl rand -base64 32
NEXTAUTH_SECRET=CHANGE_THIS_NEXTAUTH_SECRET

# ============================================
# Redis Configuration
# ============================================
# Development: Use local Redis
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_USERNAME=
# REDIS_PASSWORD=

# Production: Use managed Redis (Redis Cloud example)
# NOTE: REDIS_HOST must be just the hostname (no ":port").
REDIS_HOST=your-redis-host.redis-cloud.com
REDIS_DB=0
REDIS_PORT=19980
REDIS_USERNAME=default
REDIS_PASSWORD=YOUR_REDIS_PASSWORD

# Cloud services required for deployment (Coolify or similar):
# - DATABASE_URL
# - REDIS_URL (or REDIS_HOST/REDIS_PORT)
# - CELERY_BROKER_URL
# - CELERY_RESULT_BACKEND
# - MINIO_ENDPOINT
# - MINIO_ACCESS_KEY
# - MINIO_SECRET_KEY
# - MINIO_BUCKET

# Optional (recommended): single URL form. Use `rediss://` if your provider requires TLS.
# If REDIS_URL is set, it takes precedence over REDIS_HOST/REDIS_PORT.
# Examples:
# REDIS_URL=redis://default:YOUR_REDIS_PASSWORD@your-redis-host.redis-cloud.com:19980/0
# REDIS_URL=rediss://default:YOUR_REDIS_PASSWORD@your-redis-host.redis-cloud.com:19980/0
REDIS_URL=

# Optional: only used when configuring via REDIS_HOST/REDIS_PORT.
# Valid values: true/false
REDIS_SSL=

# Celery should point to the same Redis instance (if Celery is used).
CELERY_BROKER_URL=
CELERY_RESULT_BACKEND=

# ============================================
# MinIO Object Storage
# ============================================
MINIO_ENDPOINT=minio:9000
MINIO_ACCESS_KEY=YOUR_MINIO_ACCESS_KEY
MINIO_SECRET_KEY=YOUR_MINIO_SECRET_KEY
MINIO_BUCKET=content-resources
MINIO_SECURE=false

# ============================================
# API Keys
# ============================================
# Google Gemini API (Required for AI features)
GOOGLE_GENAI_API_KEY=YOUR_GOOGLE_GEMINI_API_KEY

# Together AI (Optional)
TOGETHER_API_KEY=YOUR_TOGETHER_API_KEY

# ============================================
# Twitter API (Optional)
# ============================================
TWITTER_API_KEY=YOUR_TWITTER_API_KEY
TWITTER_API_SECRET=YOUR_TWITTER_API_SECRET
TWITTER_ACCESS_TOKEN=YOUR_TWITTER_ACCESS_TOKEN
TWITTER_ACCESS_TOKEN_SECRET=YOUR_TWITTER_ACCESS_TOKEN_SECRET
TWITTER_BEARER_TOKEN=YOUR_TWITTER_BEARER_TOKEN

# ============================================
# Frontend / Backend URLs
# ============================================
# This repository can be run in two common modes:
# 1) Local development (host browser talks to localhost)
# 2) Production split-subdomain (frontend and backend served on different subdomains)

# Local development example (recommended to keep behaviour similar to production):
# - Frontend: http://localhost:22000
# - Backend:  http://localhost:22001
#
# NEXTAUTH_URL=http://localhost:22000
# NEXT_PUBLIC_API_URL=http://localhost:22001
# NEXT_PUBLIC_BACKEND_BASE=http://localhost:22001
# NEXT_PUBLIC_BACKEND_WS_BASE=ws://localhost:22001
# INTERNAL_API_URL=http://backend:22001

# Production split-subdomain example:
# - Frontend: https://aicare.sumbu.xyz
# - Backend:  https://api.aicare.sumbu.xyz
NEXTAUTH_URL=https://aicare.sumbu.xyz
NEXT_PUBLIC_API_URL=https://api.aicare.sumbu.xyz
NEXT_PUBLIC_BACKEND_BASE=https://api.aicare.sumbu.xyz
NEXT_PUBLIC_BACKEND_WS_BASE=wss://api.aicare.sumbu.xyz

# INTERNAL_API_URL is used by server-side Next.js code (SSR / route handlers).
# In Docker Compose it is typically the internal service name; in hosted deployments it can be the public API domain.
INTERNAL_API_URL=http://backend:22001

# ============================================
# Google OAuth Configuration
# ============================================
GOOGLE_CLIENT_ID=YOUR_GOOGLE_CLIENT_ID.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=YOUR_GOOGLE_CLIENT_SECRET

# IMPORTANT: Add these to Google OAuth Authorized Redirect URIs:
# https://yourdomain.com/api/auth/callback/google
# https://api.yourdomain.com/api/auth/callback/google

# ============================================
# WalletConnect (Optional)
# ============================================
NEXT_PUBLIC_WALLETCONNECT_PROJECT_ID=YOUR_WALLETCONNECT_PROJECT_ID

# ============================================
# Admin Credentials
# ============================================
ADMIN_EMAIL=admin@yourdomain.com
ADMIN_PASSWORD=CHANGE_THIS_STRONG_PASSWORD

# ============================================
# Counselor Credentials
# ============================================
COUNSELOR_EMAIL=counselor@yourdomain.com
COUNSELOR_PASSWORD=CHANGE_THIS_STRONG_PASSWORD
COUNSELOR_NAME=Main Counselor

# ============================================
# Web3 / Blockchain
# ============================================

# EDUChain Testnet (Journal NFT Badges)
NFT_CONTRACT_ADDRESS=0x8c251c055BC712246392C8229e5ad95859c48AFe
EDU_TESTNET_RPC_URL=https://rpc.open-campus-codex.gelato.digital
EDU_CHAIN_TESTNET_CHAIN_ID=656476

# BNB Smart Chain (Multi-Chain Badge NFTs)
# Testnet
BSC_TESTNET_RPC_URL=https://data-seed-prebsc-1-s1.bnbchain.org:8545
BSC_NFT_CONTRACT_ADDRESS=YOUR_BSC_TESTNET_NFT_CONTRACT_ADDRESS
BSC_MINTER_PRIVATE_KEY=YOUR_BSC_MINTER_PRIVATE_KEY_WITHOUT_0x_PREFIX
# Mainnet (optional, leave empty if not deploying to mainnet)
BSC_MAINNET_RPC_URL=https://bsc-dataseed.bnbchain.org
BSC_MAINNET_NFT_CONTRACT_ADDRESS=
BSC_MAINNET_MINTER_PRIVATE_KEY=

# SOMNIA Blockchain ($CARE Token)
# Testnet: https://dream-rpc.somnia.network/ (Chain ID: 50312)
# Mainnet: https://api.infra.mainnet.somnia.network/ (Chain ID: 5031)
SOMNIA_RPC_URL=https://dream-rpc.somnia.network/
CARE_TOKEN_ADDRESS=YOUR_DEPLOYED_CARE_TOKEN_ADDRESS
CARE_TOKEN_NETWORK=testnet

# SOMNIA Smart Contract Addresses
# Platform Revenue Oracle (for monthly revenue reports)
PLATFORM_REVENUE_ORACLE_ADDRESS=YOUR_PLATFORM_REVENUE_ORACLE_ADDRESS

# CARE Token Controller (for managing token minting/burning)
CARE_TOKEN_CONTROLLER_ADDRESS=YOUR_CARE_TOKEN_CONTROLLER_ADDRESS

# CARE Staking Contract (Halal-compliant staking)
CARE_STAKING_HALAL_ADDRESS=YOUR_CARE_STAKING_HALAL_ADDRESS

# Private Keys (SECURITY CRITICAL - NEVER COMMIT REAL VALUES!)
# EDUChain: Used for minting Journal NFT badges
BACKEND_MINTER_PRIVATE_KEY=YOUR_PRIVATE_KEY_WITHOUT_0x_PREFIX

# SOMNIA: Finance team private key for submitting revenue reports on-chain
FINANCE_TEAM_PRIVATE_KEY=YOUR_FINANCE_TEAM_PRIVATE_KEY_WITHOUT_0x_PREFIX

# SOMNIA: Minter private key for minting $CARE token rewards (needs MINTER_ROLE)
CARE_MINTER_PRIVATE_KEY=YOUR_CARE_MINTER_PRIVATE_KEY_WITHOUT_0x_PREFIX

# WARNING: Keep private keys secure! For production:
# - Use environment-specific .env files (NOT committed to Git)
# - Consider secrets management services (AWS Secrets Manager, HashiCorp Vault, etc.)
# - Never log or expose private keys in application logs
# - Rotate keys regularly and use separate keys for different environments

# ============================================
# Backend Configuration
# ============================================
APP_ENV=production

# External ports for Docker Compose (optional)
BACKEND_EXTERNAL_PORT=22001
FRONTEND_EXTERNAL_PORT=22000

# Backend URLs
# Development: http://localhost:22001
# Production: https://api.aicare.sumbu.xyz
FRONTEND_URL=https://aicare.sumbu.xyz
BACKEND_URL=https://api.aicare.sumbu.xyz

# CORS Origins (comma-separated)
# For split-subdomain deployments, the backend should allow the frontend origin.
ALLOWED_ORIGINS=https://aicare.sumbu.xyz,http://localhost:22000,http://127.0.0.1:22000
LOG_LEVEL=INFO
WORKERS_PER_CORE=4

# ============================================
# Rate Limiting Configuration
# ============================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_BYPASS_ADMIN=true

# Rate limits for students
RATE_LIMIT_CHAT_PER_MINUTE_STUDENT=10
RATE_LIMIT_CHAT_PER_HOUR_STUDENT=100
RATE_LIMIT_CHAT_PER_DAY_STUDENT=500

# Rate limits for counsellors
RATE_LIMIT_CHAT_PER_MINUTE_COUNSELLOR=30
RATE_LIMIT_CHAT_PER_HOUR_COUNSELLOR=300
RATE_LIMIT_CHAT_PER_DAY_COUNSELLOR=2000

# Rate limits for analytics endpoints
RATE_LIMIT_ANALYTICS_PER_MINUTE_STUDENT=5
RATE_LIMIT_ANALYTICS_PER_HOUR_STUDENT=30
RATE_LIMIT_ANALYTICS_PER_DAY_STUDENT=100

# ============================================
# Caching Configuration
# ============================================
CACHE_ENABLED=true
CACHE_DEFAULT_TTL=3600           # 1 hour
CACHE_USER_SUMMARY_TTL=1800      # 30 minutes
CACHE_JOURNAL_TTL=900            # 15 minutes
CACHE_RESOURCE_TTL=86400         # 24 hours
CACHE_CBT_MODULE_TTL=86400       # 24 hours
CACHE_USER_PROFILE_TTL=3600      # 1 hour

# ============================================
# Development Flags
# ============================================
# Set to 'true' to enable hardcoded admin@ugm.ac.id login (DEV ONLY!)
ALLOW_DEV_CREDENTIALS=false

# ============================================
# Langfuse (Agent Tracing & LLM Observability)
# ============================================
# Enable/disable Langfuse tracing
LANGFUSE_ENABLED=false

# Langfuse host URL (default: http://localhost:8262)
LANGFUSE_HOST=http://localhost:8262

# Langfuse API credentials (generate from Langfuse UI after first start)
LANGFUSE_PUBLIC_KEY=pk-lf-your-public-key-here
LANGFUSE_SECRET_KEY=sk-lf-your-secret-key-here

# Langfuse NextAuth secrets (REQUIRED - generate with: openssl rand -base64 32)
LANGFUSE_SECRET=CHANGE_THIS_TO_A_RANDOM_STRING_MIN_32_CHARS
LANGFUSE_SALT=CHANGE_THIS_TO_ANOTHER_RANDOM_STRING

# Langfuse NextAuth URL (for production, use your actual domain)
LANGFUSE_NEXTAUTH_URL=http://localhost:8262

# ============================================
# Monitoring Stack (Production)
# ============================================
# Grafana admin credentials
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=CHANGE_THIS_STRONG_PASSWORD

# Slack webhook for AlertManager (optional)
ALERTMANAGER_SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Enable/disable monitoring services
MONITORING_ENABLED=true

# ============================================
# System
# ============================================
TZ=Asia/Jakarta

# ============================================
# GitHub Container Registry (for CI/CD)
# ============================================
GHCR_REPOSITORY_OWNER=gigahidjrikaaa
GIT_SHA=latest




