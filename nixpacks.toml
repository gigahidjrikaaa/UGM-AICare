# Root Nixpacks configuration for deploying UGM-AICare as a single service.
#
# Notes for Coolify:
# - This runs BOTH backend (FastAPI) and frontend (Next.js) in one container.
# - Recommended production setup is two separate services (frontend/ and backend/),
#   but this root config makes "one app" deployment easy for demos.
#
# Ports:
# - Frontend listens on $PORT (provided by Coolify)
# - Backend listens on $BACKEND_PORT (default 8000) and is accessed via Next.js rewrites

providers = ["python", "node"]

[phases.install]
cmds = [
  "python -m pip install --upgrade pip",
  "pip install -r backend/requirements.txt",
  "cd frontend && npm ci"
]

[phases.build]
cmds = [
  "cd frontend && npm run build"
]

[start]
cmd = "bash scripts/start-coolify.sh"
