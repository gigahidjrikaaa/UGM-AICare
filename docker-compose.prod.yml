# docker-compose.prod.yml
# Production environment - minimal, lean, application-only
# External services: PostgreSQL, Redis, S3 (configured in .env)
# Usage: docker compose -f docker-compose.base.yml -f docker-compose.prod.yml up -d

services:
  #################
  # Backend (FastAPI) - PROD
  #################
  backend:
    container_name: ugm_aicare_backend_prod
    ports:
      - "${BACKEND_EXTERNAL_PORT:-22001}:22001"
    deploy:
      resources:
        limits:
          memory: 4G
        reservations:
          memory: 1G
    restart: always
    networks:
      - ugm_aicare_network

  #################
  # Frontend (Next.js) - PROD
  #################
  frontend:
    container_name: ugm_aicare_frontend_prod
    build:
      target: production
    ports:
      - "${FRONTEND_EXTERNAL_PORT:-22000}:22000"
    deploy:
      resources:
        limits:
          memory: 6G
        reservations:
          memory: 2G
    restart: always
    networks:
      - ugm_aicare_network

volumes: {}

networks:
  ugm_aicare_network:
    driver: bridge
